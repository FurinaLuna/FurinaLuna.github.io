---
title: 快速幂运算
tags: 算法 快速幂
categories: 算法
abbrlink: 716f5d8f
date: 2025-11-17 09:41:17
---

**提升效率的快速幂运算**
## 快速幂
## 时间复杂度 $O(\log_2 n)$
(n为幂次)

## 代码实现
```
long long fastpow(long long a, long long b)
{
    long long ans = 1;
    while (b)
    {
        if (b % 2 == 1)
            ans = ans * a;
        a = a * a;
        b >>= 1;
    }
    return ans;
}
```
## 变体-大数取模
一般能用到快速幂算法的，答案都会非常巨大，肯定是超出已有数据类型范围的，所以题目一般会说答案对某个数字取模。快速幂可以完成这个操作，只需要进行很小的修改。
## 时间复杂度 $O(\log_2 n)$
(n为幂次)
## 代码实现
```
long long fastpow(long long a, long long b, long long mod)
{
    a %= mod;//开头先取一次模
    long long ans = 1;
    while (b)
    {
        if (b % 2 == 1)
            ans = ans * a % mod;//每次运算都取模
        a = a * a % mod;//每次运算都取模
        b >>= 1;
    }
    return ans;
}
```
## 例题
[P1226 【模板】快速幂||取余运算](https://www.luogu.com.cn/problem/P1226)